- improve utils

Imported from https://latebindingapi.codeplex.com/SourceControl/changeset/113238
